<!doctype html>
<html>
  <head>
    <title>Decision Kitty üêæ</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap");
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Poppins", sans-serif;
        min-height: 100vh;
        background: linear-gradient(
          135deg,
          #ffeef8 0%,
          #f8d7e9 50%,
          #e8c7d9 100%
        );
        overflow-x: hidden;
        cursor: none;
      }
      .bow-cursor {
        position: fixed;
        width: 40px;
        height: 40px;
        background:
          radial-gradient(circle at 30% 30%, #ff69b4 20%, transparent 20%),
          radial-gradient(circle at 70% 30%, #ff1493 20%, transparent 20%),
          radial-gradient(circle at 50% 70%, #ffc0cb 30%, transparent 30%);
        border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
        pointer-events: none;
        z-index: 9999;
        transition: transform 0.1s ease;
        box-shadow: 0 4px 15px rgba(255, 105, 180, 0.5);
      }
      body,
      button,
      input {
        cursor: none !important;
      }
      .header {
        text-align: center;
        padding: 30px;
        color: #ff69b4;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }
      h1 {
        font-size: 3em;
        margin-bottom: 10px;
        background: linear-gradient(45deg, #ff69b4, #ff1493, #ffc0cb);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: glow 2s ease-in-out infinite alternate;
      }
      @keyframes glow {
        from {
          filter: drop-shadow(0 0 5px #ff69b4);
        }
        to {
          filter: drop-shadow(0 0 20px #ff1493);
        }
      }
      .buttons {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        padding: 50px 20px;
        max-width: 800px;
        margin: 0 auto;
      }
      .btn {
        flex: 1;
        min-width: 180px;
        padding: 20px 30px;
        font-size: 1.4em;
        font-weight: 600;
        border: none;
        border-radius: 25px;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        text-decoration: none;
        color: white;
      }
      .btn:hover {
        transform: translateY(-10px) scale(1.05);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      }
      .btn:active {
        transform: translateY(-5px) scale(1.02);
      }
      .home {
        background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
      }
      .outfits {
        background: linear-gradient(45deg, #4ecdc4, #44a08d);
      }
      .outings {
        background: linear-gradient(45deg, #45b7d1, #96c93d);
      }
      .meals {
        background: linear-gradient(45deg, #f9ca24, #f0932b);
      }
      .surprise {
        background: linear-gradient(45deg, #ffd700, #ffed4a);
        min-width: 220px;
        font-size: 1.3em;
        animation: sparkle 1.5s ease-in-out infinite;
      }

      /* SPINNING WHEEL */
      .wheel-container {
        position: relative;
      }
      .wheel-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 25px;
        background: rgba(255, 255, 255, 0.95);
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10;
        backdrop-filter: blur(10px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }
      .wheel-overlay.active {
        display: flex;
        animation: fadeIn 0.3s ease;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .wheel-wrapper {
        position: relative;
        width: 160px;
        height: 160px;
        margin-bottom: 10px;
      }
      .wheel-spinner {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: conic-gradient(
          #ff6b6b 0deg 90deg,
          /* Home */ #4ecdc4 90deg 180deg,
          /* Outfits */ #45b7d1 180deg 270deg,
          /* Outings */ #f9ca24 270deg 360deg /* Meals */
        );
        animation: spinWheel 3s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        position: relative;
      }
      @keyframes spinWheel {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(1080deg);
        }
      }

      .wheel-pointer {
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 28px;
        color: #ff1493;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        z-index: 20;
      }
      .wheel-result {
        font-size: 16px;
        color: #ff69b4;
        font-weight: 600;
        margin-top: 8px;
        min-height: 24px;
        text-align: center;
      }

      @keyframes sparkle {
        0%,
        100% {
          box-shadow: 0 0 20px #ffd700;
        }
        50% {
          box-shadow: 0 0 40px #ffd700;
        }
      }
      .custom-section {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 20px;
        padding: 25px;
        margin: 30px auto;
        max-width: 500px;
        text-align: center;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }
      .custom-input {
        width: 70%;
        padding: 12px 20px;
        border: 3px solid #ff69b4;
        border-radius: 25px;
        font-size: 1.1em;
        text-align: center;
        margin-right: 10px;
      }
      .custom-btn {
        padding: 12px 25px;
        background: linear-gradient(45deg, #ff69b4, #ff1493);
        color: white;
        border: none;
        border-radius: 25px;
        font-size: 1.1em;
        cursor: none;
      }
      .result {
        text-align: center;
        margin-top: 50px;
        padding: 30px;
        min-height: 150px;
        animation: slideUp 0.5s ease-out;
      }
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .choice {
        font-size: 2.5em;
        color: #ff69b4;
        margin: 20px 0;
        font-weight: 600;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        animation: bounce 0.6s ease-out;
      }
      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-10px);
        }
        60% {
          transform: translateY(-5px);
        }
      }
      .history {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        margin: 30px auto;
        max-width: 500px;
        padding: 25px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }
      .history h3 {
        color: #ff69b4;
        margin-bottom: 15px;
        font-size: 1.5em;
      }
      .history-item {
        padding: 10px;
        margin: 8px 0;
        background: linear-gradient(45deg, #ffeef8, #f8d7e9);
        border-radius: 15px;
        border-left: 4px solid #ff69b4;
        font-size: 1.1em;
      }
      @media (max-width: 768px) {
        h1 {
          font-size: 2em;
        }
        .btn {
          min-width: 150px;
          padding: 15px 20px;
          font-size: 1.2em;
        }
      }
    </style>
  </head>
  <body>
    <div class="bow-cursor" id="bowCursor"></div>

    <div class="header">
      <h1>üêæ Decision Kitty üêæ</h1>
      <p>Let me choose for you meow! üòª</p>
    </div>

    <div class="buttons">
      <form method="POST" style="flex: 1; min-width: 180px">
        <button type="submit" name="category" value="home" class="btn home">
          üè† Home
        </button>
      </form>
      <form method="POST" style="flex: 1; min-width: 180px">
        <button
          type="submit"
          name="category"
          value="outfits"
          class="btn outfits"
        >
          üëó Outfits
        </button>
      </form>
      <form method="POST" style="flex: 1; min-width: 180px">
        <button
          type="submit"
          name="category"
          value="outings"
          class="btn outings"
        >
          üåü Outings
        </button>
      </form>
      <form method="POST" style="flex: 1; min-width: 180px">
        <button type="submit" name="category" value="meals" class="btn meals">
          üçï Meals
        </button>
      </form>

      <!-- FIXED SPINNING WHEEL -->
      <div style="flex: 1; min-width: 220px; position: relative">
        <form method="POST" id="surpriseForm">
          <button
            type="submit"
            name="category"
            value="surprise"
            class="btn surprise wheel-container"
          >
            üé≤ Surprise Me!
          </button>
        </form>
        <div class="wheel-overlay" id="wheelOverlay">
          <div class="wheel-wrapper">
            <div class="wheel-spinner" id="wheelSpinner"></div>
            <div class="wheel-pointer">‚ñº</div>
          </div>
          <div class="wheel-result" id="wheelResult">Click to spin!</div>
        </div>
      </div>
    </div>

    <!-- Custom Option -->
    <form method="POST" class="custom-section">
      <p>
        üêæ Or type your own:
        <input
          type="text"
          class="custom-input"
          name="custom_option"
          placeholder="My red sneakers..."
        />
        <button type="submit" class="custom-btn">Add & Decide! ‚ú®</button>
      </p>
    </form>

    <!-- Result -->
    {% if choice %}
    <div class="result">
      <h2>üéâ Kitty chose:</h2>
      <div class="choice">{{ choice }}</div>
      <p>Trust the kitty wisdom! üêæ‚ú®</p>
    </div>
    {% endif %}

    <!-- Decision History -->
    {% if history %}
    <div class="history">
      <h3>üêæ Kitty's Recent Choices:</h3>
      {% for item in history %}
      <div class="history-item">
        {{ item.choice }}
        <span style="float: right; color: #666; font-size: 0.9em"
          >{{ item.time }}</span
        >
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <script>
      // Bow Cursor
      const bowCursor = document.getElementById("bowCursor");
      document.addEventListener("mousemove", (e) => {
        bowCursor.style.left = e.clientX - 20 + "px";
        bowCursor.style.top = e.clientY - 20 + "px";
      });

      // Button hover animations
      document.querySelectorAll(".btn").forEach((btn) => {
        btn.addEventListener("mouseenter", () => {
          bowCursor.style.transform = "scale(1.3) rotate(10deg)";
        });
        btn.addEventListener("mouseleave", () => {
          bowCursor.style.transform = "scale(1)";
        });
      });

      // FIXED SPINNING WHEEL - PICKS REAL OPTION!
      const surpriseForm = document.getElementById("surpriseForm");
      const wheelOverlay = document.getElementById("wheelOverlay");
      const wheelResult = document.getElementById("wheelResult");

      // All possible options (matching app.py)
      const options = {
        home: [
          "Relax on couch üõãÔ∏è",
          "Watch Netflix üì∫",
          "Play with kitty üê±",
          "Nap time üò¥",
        ],
        outfits: [
          "Casual jeans üëñ",
          "Party dress ‚ú®",
          "Sporty look üèÉ‚Äç‚ôÄÔ∏è",
          "Cozy sweater üß•",
        ],
        outings: [
          "Coffee shop ‚òï",
          "Park walk üå≥",
          "Movie night üé¨",
          "Shopping spree üõçÔ∏è",
        ],
        meals: [
          "Pizza party üçï",
          "Healthy salad ü•ó",
          "Pasta love üçù",
          "Ice cream dessert üç¶",
        ],
      };

      surpriseForm.addEventListener("submit", function (e) {
        e.preventDefault();

        // Show wheel
        wheelOverlay.classList.add("active");
        wheelResult.textContent = "Spinning... üåÄ";

        // Pick random category first
        const categories = Object.keys(options);
        const randomCategory =
          categories[Math.floor(Math.random() * categories.length)];

        // Pick random option from that category
        const randomOption =
          options[randomCategory][
            Math.floor(Math.random() * options[randomCategory].length)
          ];

        // Spin for 3 seconds, then show result
        setTimeout(() => {
          wheelResult.innerHTML = `üéâ <strong>${randomOption}</strong>`;
          wheelResult.style.color = "#ff1493";

          // Auto-submit with the chosen option
          setTimeout(() => {
            // Create hidden form with result
            const formData = new FormData();
            formData.append("category", randomCategory);
            formData.append("custom_option", randomOption);

            // Submit to Flask
            fetch("/", {
              method: "POST",
              body: formData,
            }).then(() => {
              window.location.reload();
            });
          }, 1500);
        }, 3000);
      });
    </script>
  </body>
</html>
